<!-- filepath: /e:/Users/jerbc/Documents/DJANGO/synes/app_synes/templates/app_synes/listar_jogos.html -->
{% extends 'app_synes/base.html' %}
{% load static %}
{% block title %}CadêURacha - Meus Jogos{% endblock %}
{% block content %}
<style>

h2 b span {
    color: var(--true-orange);
}

.container .row {
    scrollbar-width: none;
    -ms-overflow-style: none;
}

.container .row::-webkit-scrollbar {
    display: none;
}a

.card-img-overlay .texts {
    transform: translateY(4rem);
}

.card-img-overlay i {
    position: absolute;
    font-size: 25px;
    top: 6;
    right: 0;
    transform: translateX(-.6rem);
}

.card img {
    border-radius: 20px !important;
    object-fit: cover;
    filter: blur(1px) brightness(0.7) saturate(0.8) contrast(0.5);
    width: 100%;
    height: 100%;
    mix-blend-mode: overlay;
}

.cream {
    padding: 3rem !important;
    background-color: var(--cream);
}

.card {
    border-radius: 20px !important;
    width: 160px !important;
    height: 160px !important;
    background: linear-gradient(180deg, #9f84f9BB, #fdc4a89f);
    cursor: pointer;
}

.no-style {
    background: transparent;
    border: 0;
}

.arrow {
    font-size: 70px;
    color: var(--true-orange);
    cursor: pointer;
}

.row {
    gap: 38px !important;
    scroll-behavior: smooth;
}

.row a {
    margin: 0 !important;
    padding: 0 !important;
    width: fit-content;
}

#MarcarRacha{
    background-color: var(--true-orange);
    font-size: 22px;
    color: var(--cream);
    margin: 30px;
    display: flex;
    align-items: center;
}

#MarcarRacha b {
    margin-right: 1rem;
}

#MarcarRacha i {
    font-size: 24px;
}


@media (max-width: 500px) {

    h2 {
        font-size: 22px !important;
    }

    .row {
        gap: 10px;
    }

    .card h5 {
        font-size: 13px !important;
    }

    .card p {
        font-size: 10px !important;
        transform: translateY(-.4rem);
    }

    .container {
        width: 60% !important;
        padding: 2rem !important;
    }

    .card {
        width: 120px !important;
        height: 120px !important;
    }

    #Agrupador {
        width: 100% !important;
    }
}

.container.shadow.rounded-5.cream {
    width: 1000px;  /* ajuste o valor conforme necessário */
    height: 250px; /* ajuste o valor conforme necessário */
    overflow: hidden; /* garante que o conteúdo não afete o tamanho */
}

/* Adicione essa regra para impedir a quebra de linha da data */
.card-img-overlay .texts h5,
.card-img-overlay .texts h5 b {
    white-space: nowrap;
}
</style>

<div class="group w-100">

    <div class="d-flex mt-7 mb-3 justify-content-center w-100">
        <a href="{% url 'cadastrar_jogo' %}" class="text-decoration-none">
          <button id="MarcarRacha" class="rounded border-0 h-50 p-2" aria-label="Marcar Racha">
            <b>Marcar Racha</b>
            <i class="bi bi-plus-circle"></i>
          </button>
        </a>
      </div>

    <!-- Jogos que Criei -->
    <div class="d-flex justify-content-center flex-wrap mb-4">
      <h3 class="w-100 text-center">Jogos que <b>Criei:</b></h3>
      <div id="Agrupador" class="d-flex align-items-center w-85">

        <button class="no-style">
          <i class='bx bx-chevron-left arrow'></i>
        </button>

        <div class="container shadow rounded-5 cream">
          <div class="row d-flex flex-nowrap overflow-auto w-100">
            {% for jogo in jogos_criados %}
              <a href="#">
                <div class="card border-0 text-bg-dark ratio ratio-1x1">
                  <img src="{% static 'app_synes/images/space.jpg' %}" class="card-img" alt="Imagem de promoção de Jogo">
                  <div class="card-img-overlay">
                    <i class='bx bxs-basketball'></i>
                    <div class="texts">
                      <!-- Exibe a data completa em uma linha -->
                      <h5 class="card-title text-center">
                        <b>{{ jogo.data|date:"d/m/Y" }}</b>
                      </h5>
                      <!-- A exibição do horário será alterada via JavaScript para incluir o fim (2h depois) -->
                      <p class="card-title text-center">
                        <b class="jogo-horario">{{ jogo.horario }}</b>
                      </p>
                    </div>
                  </div>
                </div>
              </a>
            {% empty %}
              <p class="text-center">Nenhum jogo criado.</p>
            {% endfor %}
          </div>
        </div>

        <button class="no-style">
          <i class='bx bx-chevron-right arrow'></i>
        </button>

      </div>
    </div>

    <!-- Jogos que Confirmei Presença -->
    <div class="d-flex justify-content-center flex-wrap">
      <h3 class="w-100 text-center">Jogos que <b>Confirmei Presença:</b></h3>
      <div id="Agrupador" class="d-flex align-items-center w-85">

        <button class="no-style">
          <i class='bx bx-chevron-left arrow'></i>
        </button>

        <div class="container shadow rounded-5 cream">
          <div class="row d-flex flex-nowrap overflow-auto w-100">
            {% for jogo in jogos_confirmados %}
              {% if request.user in jogo.participantes.all and jogo.criador_jogo != request.user %}
                <a href="#">
                  <div class="card border-0 text-bg-dark ratio ratio-1x1">
                    <img src="{% static 'app_synes/images/space.jpg' %}" class="card-img" alt="Imagem de promoção de Jogo">
                    <div class="card-img-overlay">
                      <i class='bx bxs-basketball'></i>
                      <div class="texts">
                        <h5 class="card-title text-center">
                          <b>{{ jogo.data|date:"d/m/Y" }}</b>
                        </h5>
                        <p class="card-title text-center">
                          <b>{{ jogo.horario }}</b>
                        </p>
                      </div>
                    </div>
                  </div>
                </a>
              {% endif %}
            {% empty %}
              <p class="text-center">Nenhum jogo com presença confirmada.</p>
            {% endfor %}
          </div>
        </div>

        <button class="no-style">
          <i class='bx bx-chevron-right arrow'></i>
        </button>

      </div>
    </div>

</div>

<script>
// Para cada elemento de horário, calcula o horário final 2 horas à frente
document.querySelectorAll('.jogo-horario').forEach(function(elem) {
    let start = elem.textContent.trim();
    // Pressupõe o formato "HH:MM" (ex.: "20:00")
    let parts = start.split(':');
    if (parts.length === 2) {
        let hours = parseInt(parts[0], 10);
        let minutes = parseInt(parts[1], 10);
        // Calcula o horário final adicionando 2 horas
        let endHours = (hours + 2) % 24;
        // Função para garantir 2 dígitos
        let pad = num => (num < 10 ? '0' + num : num);
        elem.textContent = pad(hours) + ':' + pad(minutes) + ' - ' + pad(endHours) + ':' + pad(minutes);
    }
});
</script>

{% endblock %}